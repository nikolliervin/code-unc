"""Main CLI entry point using Typer."""

import typer
from rich.console import Console

from .. import __version__
from .commands import review, config, history

console = Console()

# Create main Typer application
app = typer.Typer(
    name="unc",
    help="AI-powered code review tool using git diff and various AI providers",
    no_args_is_help=True,
    rich_markup_mode="rich",
)

# Add subcommands
app.add_typer(review.app, name="review", help="Run code review on git diff")
app.add_typer(config.app, name="config", help="Manage configuration settings")
app.add_typer(history.app, name="history", help="View review history")


@app.callback()
def main(
    verbose: bool = typer.Option(False, "--verbose", "-V", help="Enable verbose output"),
    config_path: str = typer.Option(None, "--config", "-c", help="Path to configuration file"),
):
    """AI-powered code review tool using git diff and various AI providers."""
    pass


@app.command("version")
def version():
    """Show version and exit."""
    # ASCII Art
    art = """
                             =@@@+............=@@@*                           
                        .@@*........................=@@:                      
                      @#................................=@:                   
        *@.  -@@   @@......................................%@   %@=   @@      
       @         @#.................--------:................=@         @     
      @          *.....................:::....:...:::.........-          @    
      @         ................:--..........:--.....:.........+         +-   
     *:         *....:%@@@@@@@@@@@@..........%@@@@@@@@@@@@- ...*          @   
     @:       .%@@@@@@@@@@@=.   :@@@@=+**+=@@@@-   .-%@@@@@@@@@@@:        @   
     @:....@@@@@@@@@@*.............@@@@@@@@@@.............+@@@@@@@@@@:....@   
     #=...:@@@@@@@@*........@*.*@...@@@@@@@@ ..@-.@%........-@@@@@@@@=...:@   
     =@...%.@@@@@@@ .......@....:#..#@....@@..@.....+....... @@@@@@@-*...@%   
    =@...-#.... @@@+.......+.....-.+@@+==+%@*.+.....+.......:@@@-....--...=@  
    @ ..-=-.....*@@@............:%------------*=............@@@@......=-.. @  
    #*..-=-......@@@*..........%----------------@..........-@@@.......+-..-@  
     *@...+.......@@@..........@----------------@..........@@@.......:...#@   
        -*@........%@@#....:%@@@+--------------=@@@@:....*@@@........*#=      
          @.........*@@@@@@@@    @+----------=@    @@@@@@@@%.........@        
          :@...........:..=         :+#@@%*-         *..:...........%*        
           %*............*                            @............=@         
            @=...........@                            %...........:@          
             %%............%-                      -@............+@           
               @...............:#%.           #%:...............@:            
                #@............................................%@              
                  @@........................................@@                
                    -@*..................................=@+                   
                       +@@............................#%**@                   
                      @#****#%%:................:%@%*******@@                 
                    %@**********@     .*@-      %*******%****@                
                   @*************@  @#*****%@ .#********#@***#@               
              %@@@@*****#@*******************************@%***@.              
           @@:......@*#@-@*******************************@****@.              
         .@%%%@@%+..@@. +%*******************************@***@%               
         @%%@@@@%%@*    @#*******************************@%@@                 
         @%%@   @%@@    @********************************@                    
         +@@-  .@%@@    @********************************@.                   
               :@%@@    @********************************@.                   
               -@%@@    @********************************@.                   
               =@%@@    @#*******************************@                    
               +@%@@    =@%%@@@##******************#%@@%%@                    
               *@%@@    .@%%%%%%%%%%%@@@@@@@@@@%%%%%%%%%%@                    
               %@%@@     @%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%                    
               @@%@@     @%%%%%%%%%%%%%%@@%%%%%%%%%%%%%%@-                    
               @@%@@     @@%%%%%%%%%%%@+   @@%%%%%%%%%%%@                     
               @@%@@      @%%%%%%%%%@@      :@%%%%%%%%%%@                     
               @%%@@      @%%%%%%%%%@        @@%%%%%%%%@*                     
               @%%@@      #@%%%%%%%%@         @%%%%%%%%@                      
               @%%@@      +@@%%%%%%@:         @@%%%%%@@@                      
               @%%@@    -@#######@@@          @@@%#######@                    
               @@@@:    @@@@@@@@@@@@          @@@@@@@@@@@@                    
"""
    
    console.print(art, style="cyan")
    console.print(f"unc version {__version__}", style="bold green")
    raise typer.Exit()


if __name__ == "__main__":
    app() 